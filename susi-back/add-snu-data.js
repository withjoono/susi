const XLSX = require('xlsx');

// 서울대학교 2026학년도 수시모집 접수현황 데이터 (PDF에서 추출)
const snuData = [
  // 인문대학
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '인문계열', 모집인원: 27, 지원인원: 120, 경쟁률: 4.44 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '국어국문학과', 모집인원: 9, 지원인원: 92, 경쟁률: 10.22 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '중어중문학과', 모집인원: 9, 지원인원: 67, 경쟁률: 7.44 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '영어영문학과', 모집인원: 9, 지원인원: 83, 경쟁률: 9.22 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '불어불문학과', 모집인원: 9, 지원인원: 55, 경쟁률: 6.11 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '독어독문학과', 모집인원: 9, 지원인원: 58, 경쟁률: 6.44 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '노어노문학과', 모집인원: 9, 지원인원: 54, 경쟁률: 6.00 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '서어서문학과', 모집인원: 9, 지원인원: 62, 경쟁률: 6.89 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '언어학과', 모집인원: 9, 지원인원: 81, 경쟁률: 9.00 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '아시아언어문명학부', 모집인원: 9, 지원인원: 89, 경쟁률: 9.89 },
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '역사학부', 모집인원: 9, 지원인원: 17, 경쟁률: 1.89 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '역사학부', 모집인원: 9, 지원인원: 110, 경쟁률: 12.22 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '고고미술사학과', 모집인원: 9, 지원인원: 103, 경쟁률: 11.44 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '철학과', 모집인원: 9, 지원인원: 140, 경쟁률: 15.56 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '종교학과', 모집인원: 9, 지원인원: 138, 경쟁률: 15.33 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '미학과', 모집인원: 9, 지원인원: 113, 경쟁률: 12.56 },

  // 사회과학대학
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '정치외교학부', 모집인원: 17, 지원인원: 63, 경쟁률: 3.71 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '정치외교학부', 모집인원: 25, 지원인원: 260, 경쟁률: 10.40 },
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '경제학부', 모집인원: 7, 지원인원: 27, 경쟁률: 3.86 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '경제학부', 모집인원: 60, 지원인원: 296, 경쟁률: 4.93 },
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '사회학과', 모집인원: 6, 지원인원: 18, 경쟁률: 3.00 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '사회학과', 모집인원: 10, 지원인원: 165, 경쟁률: 16.50 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '인류학과', 모집인원: 12, 지원인원: 147, 경쟁률: 12.25 },
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '심리학과', 모집인원: 6, 지원인원: 15, 경쟁률: 2.50 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '심리학과', 모집인원: 8, 지원인원: 90, 경쟁률: 11.25 },
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '지리학과', 모집인원: 6, 지원인원: 16, 경쟁률: 2.67 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '지리학과', 모집인원: 9, 지원인원: 89, 경쟁률: 9.89 },
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '사회복지학과', 모집인원: 6, 지원인원: 30, 경쟁률: 5.00 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '사회복지학과', 모집인원: 7, 지원인원: 109, 경쟁률: 15.57 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '언론정보학과', 모집인원: 12, 지원인원: 115, 경쟁률: 9.58 },

  // 자연과학대학
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '수리과학부', 모집인원: 7, 지원인원: 18, 경쟁률: 2.57 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '수리과학부', 모집인원: 16, 지원인원: 90, 경쟁률: 5.63 },
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '통계학과', 모집인원: 6, 지원인원: 15, 경쟁률: 2.50 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '통계학과', 모집인원: 13, 지원인원: 90, 경쟁률: 6.92 },
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '물리학전공', 모집인원: 8, 지원인원: 33, 경쟁률: 4.13 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '물리학전공', 모집인원: 20, 지원인원: 153, 경쟁률: 7.65 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '천문학전공', 모집인원: 6, 지원인원: 61, 경쟁률: 10.17 },
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '화학부', 모집인원: 7, 지원인원: 34, 경쟁률: 4.86 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '화학부', 모집인원: 20, 지원인원: 197, 경쟁률: 9.85 },
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '생명과학부', 모집인원: 7, 지원인원: 46, 경쟁률: 6.57 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '생명과학부', 모집인원: 27, 지원인원: 257, 경쟁률: 9.52 },
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '지구환경과학부', 모집인원: 5, 지원인원: 15, 경쟁률: 3.00 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '지구환경과학부', 모집인원: 19, 지원인원: 199, 경쟁률: 10.47 },

  // 간호대학
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '간호대학', 모집인원: 10, 지원인원: 84, 경쟁률: 8.40 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '간호대학', 모집인원: 27, 지원인원: 296, 경쟁률: 10.96 },

  // 경영대학
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '경영대학', 모집인원: 26, 지원인원: 49, 경쟁률: 1.88 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '경영대학', 모집인원: 47, 지원인원: 264, 경쟁률: 5.62 },

  // 공과대학
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '건설환경공학부', 모집인원: 8, 지원인원: 24, 경쟁률: 3.00 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '건설환경공학부', 모집인원: 26, 지원인원: 222, 경쟁률: 8.54 },
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '기계공학부', 모집인원: 16, 지원인원: 73, 경쟁률: 4.56 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '기계공학부', 모집인원: 54, 지원인원: 293, 경쟁률: 5.43 },
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '재료공학부', 모집인원: 15, 지원인원: 44, 경쟁률: 2.93 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '재료공학부', 모집인원: 37, 지원인원: 231, 경쟁률: 6.24 },
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '전기정보공학부', 모집인원: 11, 지원인원: 36, 경쟁률: 3.27 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '전기정보공학부', 모집인원: 80, 지원인원: 367, 경쟁률: 4.59 },
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '컴퓨터공학부', 모집인원: 9, 지원인원: 21, 경쟁률: 2.33 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '컴퓨터공학부', 모집인원: 36, 지원인원: 155, 경쟁률: 4.31 },
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '화학생물공학부', 모집인원: 12, 지원인원: 72, 경쟁률: 6.00 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '화학생물공학부', 모집인원: 41, 지원인원: 232, 경쟁률: 5.66 },
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '건축학과', 모집인원: 8, 지원인원: 20, 경쟁률: 2.50 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '건축학과', 모집인원: 25, 지원인원: 161, 경쟁률: 6.44 },
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '산업공학과', 모집인원: 4, 지원인원: 22, 경쟁률: 5.50 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '산업공학과', 모집인원: 17, 지원인원: 146, 경쟁률: 8.59 },
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '에너지자원공학과', 모집인원: 5, 지원인원: 17, 경쟁률: 3.40 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '에너지자원공학과', 모집인원: 15, 지원인원: 154, 경쟁률: 10.27 },
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '원자핵공학과', 모집인원: 9, 지원인원: 31, 경쟁률: 3.44 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '원자핵공학과', 모집인원: 15, 지원인원: 176, 경쟁률: 11.73 },
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '조선해양공학과', 모집인원: 6, 지원인원: 44, 경쟁률: 7.33 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '조선해양공학과', 모집인원: 22, 지원인원: 227, 경쟁률: 10.32 },
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '항공우주공학과', 모집인원: 4, 지원인원: 15, 경쟁률: 3.75 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '항공우주공학과', 모집인원: 18, 지원인원: 183, 경쟁률: 10.17 },

  // 농업생명과학대학
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '농경제사회학부', 모집인원: 11, 지원인원: 29, 경쟁률: 2.64 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '농경제사회학부', 모집인원: 15, 지원인원: 173, 경쟁률: 11.53 },
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '식물생산과학부', 모집인원: 6, 지원인원: 38, 경쟁률: 6.33 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '식물생산과학부', 모집인원: 25, 지원인원: 301, 경쟁률: 12.04 },
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '산림과학부', 모집인원: 5, 지원인원: 41, 경쟁률: 8.20 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '산림과학부', 모집인원: 19, 지원인원: 221, 경쟁률: 11.63 },
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '식품동물생명공학부', 모집인원: 7, 지원인원: 59, 경쟁률: 8.43 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '식품동물생명공학부', 모집인원: 16, 지원인원: 206, 경쟁률: 12.88 },
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '응용생물화학부', 모집인원: 9, 지원인원: 68, 경쟁률: 7.56 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '응용생물화학부', 모집인원: 15, 지원인원: 289, 경쟁률: 19.27 },
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '조경지역시스템공학부', 모집인원: 5, 지원인원: 31, 경쟁률: 6.20 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '조경지역시스템공학부', 모집인원: 14, 지원인원: 155, 경쟁률: 11.07 },
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '바이오시스템소재학부', 모집인원: 7, 지원인원: 53, 경쟁률: 7.57 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '바이오시스템소재학부', 모집인원: 13, 지원인원: 238, 경쟁률: 18.31 },
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '스마트시스템과학과', 모집인원: 4, 지원인원: 27, 경쟁률: 6.75 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '스마트시스템과학과', 모집인원: 10, 지원인원: 148, 경쟁률: 14.80 },

  // 미술대학
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '디자인과', 모집인원: 7, 지원인원: 197, 경쟁률: 28.14 },

  // 사범대학
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '교육학과', 모집인원: 11, 지원인원: 111, 경쟁률: 10.09 },
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '국어교육과', 모집인원: 5, 지원인원: 13, 경쟁률: 2.60 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '국어교육과', 모집인원: 9, 지원인원: 80, 경쟁률: 8.89 },
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '영어교육과', 모집인원: 4, 지원인원: 12, 경쟁률: 3.00 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '영어교육과', 모집인원: 12, 지원인원: 87, 경쟁률: 7.25 },
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '독어교육과', 모집인원: 4, 지원인원: 19, 경쟁률: 4.75 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '독어교육과', 모집인원: 10, 지원인원: 65, 경쟁률: 6.50 },
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '불어교육과', 모집인원: 4, 지원인원: 18, 경쟁률: 4.50 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '불어교육과', 모집인원: 10, 지원인원: 59, 경쟁률: 5.90 },
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '사회교육과', 모집인원: 5, 지원인원: 14, 경쟁률: 2.80 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '사회교육과', 모집인원: 6, 지원인원: 79, 경쟁률: 13.17 },
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '역사교육과', 모집인원: 5, 지원인원: 10, 경쟁률: 2.00 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '역사교육과', 모집인원: 6, 지원인원: 49, 경쟁률: 8.17 },
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '지리교육과', 모집인원: 5, 지원인원: 13, 경쟁률: 2.60 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '지리교육과', 모집인원: 6, 지원인원: 61, 경쟁률: 10.17 },
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '윤리교육과', 모집인원: 3, 지원인원: 10, 경쟁률: 3.33 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '윤리교육과', 모집인원: 9, 지원인원: 97, 경쟁률: 10.78 },
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '수학교육과', 모집인원: 4, 지원인원: 9, 경쟁률: 2.25 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '수학교육과', 모집인원: 11, 지원인원: 133, 경쟁률: 12.09 },
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '물리교육과', 모집인원: 3, 지원인원: 14, 경쟁률: 4.67 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '물리교육과', 모집인원: 7, 지원인원: 95, 경쟁률: 13.57 },
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '화학교육과', 모집인원: 6, 지원인원: 26, 경쟁률: 4.33 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '화학교육과', 모집인원: 7, 지원인원: 90, 경쟁률: 12.86 },
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '생물교육과', 모집인원: 5, 지원인원: 21, 경쟁률: 4.20 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '생물교육과', 모집인원: 7, 지원인원: 104, 경쟁률: 14.86 },
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '지구과학교육과', 모집인원: 3, 지원인원: 10, 경쟁률: 3.33 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '지구과학교육과', 모집인원: 9, 지원인원: 70, 경쟁률: 7.78 },
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '체육교육과', 모집인원: 2, 지원인원: 14, 경쟁률: 7.00 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '체육교육과', 모집인원: 4, 지원인원: 105, 경쟁률: 26.25 },

  // 생활과학대학
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '소비자학전공', 모집인원: 6, 지원인원: 28, 경쟁률: 4.67 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '소비자학전공', 모집인원: 8, 지원인원: 90, 경쟁률: 11.25 },
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '아동가족학전공', 모집인원: 5, 지원인원: 14, 경쟁률: 2.80 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '아동가족학전공', 모집인원: 10, 지원인원: 104, 경쟁률: 10.40 },
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '식품영양학과', 모집인원: 4, 지원인원: 36, 경쟁률: 9.00 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '식품영양학과', 모집인원: 12, 지원인원: 119, 경쟁률: 9.92 },
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '의류학과', 모집인원: 9, 지원인원: 31, 경쟁률: 3.44 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '의류학과', 모집인원: 12, 지원인원: 109, 경쟁률: 9.08 },

  // 수의과대학
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '수의예과', 모집인원: 6, 지원인원: 31, 경쟁률: 5.17 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '수의예과', 모집인원: 17, 지원인원: 182, 경쟁률: 10.71 },

  // 약학대학
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '약학계열', 모집인원: 11, 지원인원: 104, 경쟁률: 9.45 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '약학계열', 모집인원: 29, 지원인원: 261, 경쟁률: 9.00 },

  // 음악대학
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '피아노과', 모집인원: 23, 지원인원: 211, 경쟁률: 9.17 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '관현악과', 모집인원: 47, 지원인원: 374, 경쟁률: 7.96 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '국악과', 모집인원: 28, 지원인원: 242, 경쟁률: 8.64 },

  // 의과대학
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '의예과', 모집인원: 39, 지원인원: 315, 경쟁률: 8.08 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '의예과', 모집인원: 50, 지원인원: 635, 경쟁률: 12.70 },

  // 첨단융합학부
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '첨단융합학부', 모집인원: 30, 지원인원: 165, 경쟁률: 5.50 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '첨단융합학부', 모집인원: 98, 지원인원: 743, 경쟁률: 7.58 },

  // 자유전공학부
  { 대학명: '서울대학교', 전형명: '지역균형선발전형', 모집단위: '자유전공학부', 모집인원: 20, 지원인원: 127, 경쟁률: 6.35 },
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '자유전공학부', 모집인원: 48, 지원인원: 497, 경쟁률: 10.35 },

  // 치의학대학원
  { 대학명: '서울대학교', 전형명: '일반전형', 모집단위: '치의학과', 모집인원: 25, 지원인원: 245, 경쟁률: 9.80 },
];

console.log('서울대학교 데이터 수:', snuData.length);

// V6 크롤링 데이터 읽기 (최신 파일 자동 감지)
const fs = require('fs');
const files = fs.readdirSync('.').filter(f => f.startsWith('UWAY_수시_경쟁률_V6_') && f.endsWith('.xlsx'));
const latestFile = files.sort().reverse()[0];

if (!latestFile) {
  console.error('V6 크롤링 결과 파일을 찾을 수 없습니다.');
  process.exit(1);
}

console.log('읽는 파일:', latestFile);
const existingWb = XLSX.readFile(latestFile);
const existingData = XLSX.utils.sheet_to_json(existingWb.Sheets['경쟁률_상세']);
console.log('기존 데이터 수:', existingData.length);

// 서울대 데이터를 기존 형식에 맞게 변환 (경쟁률을 "X : 1" 형식으로)
const formattedSnuData = snuData.map(row => ({
  대학명: row.대학명,
  캠퍼스: '',
  전형명: row.전형명,
  모집단위: row.모집단위,
  모집인원: row.모집인원.toString(),
  지원인원: row.지원인원.toString(),
  경쟁률: row.경쟁률.toFixed(2) + ' : 1'
}));

// 기존 서울대 데이터 제거 (PDF 참조 항목)
const filteredData = existingData.filter(row => row.대학명 !== '서울대학교');
console.log('서울대 더미 데이터 제거 후:', filteredData.length);

// 병합
const mergedData = [...filteredData, ...formattedSnuData];
console.log('서울대 실제 데이터 추가 후:', mergedData.length);

// 엑셀로 저장
const wb = XLSX.utils.book_new();
const ws = XLSX.utils.json_to_sheet(mergedData);
ws['!cols'] = [
  { wch: 25 }, { wch: 15 }, { wch: 40 }, { wch: 35 }, { wch: 10 }, { wch: 10 }, { wch: 15 }
];
XLSX.utils.book_append_sheet(wb, ws, '경쟁률_상세');

// 대학별 요약 시트
const summaryByUni = {};
mergedData.forEach(row => {
  if (!summaryByUni[row.대학명]) {
    summaryByUni[row.대학명] = {
      대학명: row.대학명,
      전형수: new Set(),
      모집단위수: 0,
      총모집인원: 0,
      총지원인원: 0
    };
  }
  summaryByUni[row.대학명].전형수.add(row.전형명);
  summaryByUni[row.대학명].모집단위수++;
  summaryByUni[row.대학명].총모집인원 += parseInt(String(row.모집인원).replace(/,/g, '')) || 0;
  summaryByUni[row.대학명].총지원인원 += parseInt(String(row.지원인원).replace(/,/g, '')) || 0;
});

const summaryData = Object.values(summaryByUni).map(uni => ({
  대학명: uni.대학명,
  전형수: uni.전형수.size,
  모집단위수: uni.모집단위수,
  총모집인원: uni.총모집인원,
  총지원인원: uni.총지원인원,
  평균경쟁률: uni.총모집인원 > 0 ?
    (uni.총지원인원 / uni.총모집인원).toFixed(2) + ' : 1' : '-'
}));

const wsSummary = XLSX.utils.json_to_sheet(summaryData);
wsSummary['!cols'] = [
  { wch: 25 }, { wch: 10 }, { wch: 12 }, { wch: 12 }, { wch: 12 }, { wch: 12 }
];
XLSX.utils.book_append_sheet(wb, wsSummary, '대학별_요약');

const timestamp = new Date().toISOString().split('T')[0];
const outputFile = `UWAY_수시_경쟁률_서울대포함_${timestamp}.xlsx`;
XLSX.writeFile(wb, outputFile);
console.log('\n저장 완료:', outputFile);

// 대학별 데이터 수 확인
const uniCount = {};
mergedData.forEach(row => {
  const uni = row.대학명;
  uniCount[uni] = (uniCount[uni] || 0) + 1;
});
console.log('총 대학 수:', Object.keys(uniCount).length);
console.log('서울대학교 데이터:', uniCount['서울대학교'] || 0, '개');
console.log('총 데이터 레코드:', mergedData.length, '개');
